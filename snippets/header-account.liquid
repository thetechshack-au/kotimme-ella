{%- liquid
  assign account_type = sec_stts.account_type
  assign enable_account_drawer = sec_stts.enable_account_drawer
-%}

{% capture class_button %}
  button focus-inset account-actions header__icon header__icon--account header__icon--{{ account_type }}
{% endcapture %}

{%- capture account_icon -%}
  {%- if sec_stts.enable_customer_avatar -%}
    <account-icon class="{% if account_type == 'text' %} lg:none{% endif %}">
      {%- if customer and customer.has_avatar? -%}
        {{ customer | avatar }}
      {%- else -%}
        <span class="svg-wrapper">
          {{- 'icon-account.svg' | inline_asset_content -}}
        </span>
      {%- endif -%}
    </account-icon>
  {%- else -%}
    <span class="svg-wrapper{% if account_type == 'text' %} lg:none{% endif %}">
      {{- 'icon-account.svg' | inline_asset_content -}}
    </span>
  {%- endif -%}
{%- endcapture -%}

{% capture account_text %}
  {%- if account_type == 'text' or account_type == 'both' -%}
    <span class="text max-md:hidden">
      {%- liquid
        if customer
          echo 'customer.account_fallback' | t
        else
          echo 'customer.log_in' | t
        endif
      -%}
    </span>
  {%- endif -%}
{%- endcapture -%}

{%- if enable_account and shop.customer_accounts_enabled -%}
  {% if enable_account_drawer %}
    <side-drawer-opener class="account-actions" data-side-drawer="#Drawer-Account">
      <button class="{{ class_button }}" type="button" aria-haspopup="dialog" aria-label="{% if customer %}{{ 'customer.account_fallback' | t }}{% else %}{{ 'customer.log_in' | t }}{% endif %}">
        {{ account_icon }}
        {{ account_text }}
      </button>
    </side-drawer-opener>
  {% else %}
    <a href="{%- if customer -%}{{ routes.account_url }}{%- else -%}{{ routes.account_login_url }}{%- endif -%}" class="{{ class_button }}" aria-label="{%- if customer -%}{{ 'customer.account_fallback' | t }}{%- else -%}{{ 'customer.log_in' | t }}{%- endif -%}">
      {{ account_icon }}
      {{ account_text }}
      </a>
  {% endif %}
{%- endif -%}
